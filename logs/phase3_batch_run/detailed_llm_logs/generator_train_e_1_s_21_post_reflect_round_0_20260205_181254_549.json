{
  "role": "generator",
  "call_id": "train_e_1_s_21_post_reflect_round_0",
  "model": "gpt-5-mini",
  "prompt": "You are an analysis expert tasked with answering questions using your knowledge, a curated playbook of strategies and insights and a reflection that goes over the diagnosis of all previous mistakes made while answering the question.\n\n**Instructions:**\n- Read the playbook carefully and apply relevant strategies, formulas, and insights\n- Pay attention to common mistakes listed in the playbook and avoid them\n- Show your reasoning step-by-step\n- Be concise but thorough in your analysis\n- If the playbook contains relevant code snippets or formulas, use them appropriately\n- Double-check your calculations and logic before providing the final answer\n\nYour output should be a json object, which contains the following fields:\n- reasoning: your chain of thought / reasoning / thinking process, detailed analysis and calculations\n- bullet_ids: each line in the playbook has a bullet_id. all bulletpoints in the playbook that's relevant, helpful for you to answer this question, you should include their bullet_id in this list\n- final_answer: your concise final answer\n\n\n**Playbook:**\n## STRATEGIES & INSIGHTS\n\n## FORMULAS & CALCULATIONS\n\n## CODE SNIPPETS & TEMPLATES\n\n[code-00004] helpful=0 harmful=0 :: Regex detection template (pseudo-code): - patterns = { 'PaymentsToAcquireBusinessesGross': [/(?:aggregate\\s+|total\\s+)?purchase\\s+price/i, /cash(?:\\s+consideration)?\\s+paid/i], 'BusinessCombinationConsiderationTransferred1': [/(?:aggregate\\s+)?consideration(?:\\s+transferred)?/i], 'BusinessAcquisitionEquityInterestsIssuedOrIssuableNumberOfSharesIssued': [/issued\\s+\\d[\\d,]*/i, /shares\\s+issued/i] } - For each numeric token in sentence: find nearest matching pattern within N tokens (N=8). - Assign tag of nearest matched pattern. - If multiple tags at equal distance, apply specificity precedence: purchase_price > cash_paid > consideration. - If no match, fall back to semantic classifier but flag for review.\n## COMMON MISTAKES TO AVOID\n\n[err-00003] helpful=0 harmful=0 :: Do not conflate 'purchase price' with 'consideration'. Anti-pattern: tagging both an 'aggregate purchase price of $X' and an 'aggregate consideration of $Y' with the same 'consideration' tag. Concrete prevention: enforce lexical-match-first rule (if 'purchase price' appears, do not map that phrase to BusinessCombinationConsiderationTransferred1). Add a unit-test: example sentence 'aggregate purchase price of $162 million' must map to PaymentsToAcquireBusinessesGross; 'aggregate consideration of $1.2 billion' must map to BusinessCombinationConsiderationTransferred1.\n[err-00007] helpful=0 harmful=0 :: Anti-patterns and prevention rules (atomic): - Anti-pattern: mapping any 'per share' price to SaleOfStockPricePerShare without checking instrument class. Prevention: before assigning SaleOfStockPricePerShare check for convertible/preferred/mandatory cues in same sentence; if present, map to convertible-specific price tag. - Anti-pattern: treating 'we sold X shares' as a generic secondary sale when underwriter/overallotment/offer language is present. Prevention: if 'we sold' co-occurs with underwriter/overallotment/overallotment exercise/offer language within ±1 sentence, treat as primary issuance and map share counts to StockIssuedDuringPeriodSharesNewIssues. - Anti-pattern: applying nearest-lexical-match only. Prevention: implement precedence override: instrument-type and offering flags must be evaluated and can override nearest lexical match. - Add unit-tests for regressions: include at least 10 sentences mixing convertible language with 'per share' and 'sold' / 'offered' / 'underwriters' to ensure convertible/issuance tags win over generic sale tags.\n[err-00010] helpful=0 harmful=0 :: err-XXXX :: Anti-pattern: blanket-mapping 'availability' -> RemainingBorrowingCapacity. Prevention checklist (atomic):\n- Do not assign RemainingBorrowingCapacity solely because the word 'availability' appears. First check for a facility-capacity anchor in same or previous sentence (\"has a $X credit facility\", \"in an aggregate principal amount of up to $X\").\n- If 'availability' is used in a comparative clause referencing a previously stated cap (\"may be less than $X\" where X == stated cap), map to MaximumBorrowingCapacity (the sentence is comparing to the contractual cap or describing an effective cap constraint).\n- If the phrase contains explicit current-amount tokens (\"amount available under the facility totaled\", \"was available under the facility\"), map to RemainingBorrowingCapacity.\n- If no anchor and no explicit remaining-amount phrase exist, mark as ambiguous and require human review instead of auto-mapping.\n- Add automated unit-tests for both positive and negative examples and log ambiguous cases for retraining.\n[err-00014] helpful=0 harmful=0 :: Tie-breaker: prefer instrument-specific mapping over generic financial-category tags when instrument anchor present (atomic prevention rule): - Anti-pattern: mapping an 'interest' currency amount to generic InterestExpense or mapping a 'per annum' percentage to a spread tag without checking instrument context. - Prevention checklist (apply in order): 1) If numeric token is percentage AND 'per annum'/'per year' present AND any instrument-anchor (note/loan/term loan/seller note) in sentence ±1 -> map to DebtInstrumentInterestRateStatedPercentage. 2) If numeric token is currency AND interest lexical cue ('interest charges', 'interest expense', 'interest on') AND instrument-anchor in sentence ±1 -> map to InterestExpenseDebt (link numeric to instrument anchor). 3) If both 'spread'/'margin' and 'per annum' cues occur, prefer per-annum/stated-rate mapping; log conflict for QA. 4) If customer + revenue percent detected, map to ConcentrationRiskPercentage1; do not map to generic 'percentage' tags. 5) If instrument-anchor is absent for interest-charge currency amounts, map to generic InterestExpense and flag for human review; add the sentence to a retraining queue. - Unit-tests: include all examples referenced in the above heuristics and assert instrument-specific tags beat generic alternatives.\n[err-00002] helpful=0 harmful=0 :: Atomic negation-to-zero rule for availability quantities (prevention of treating negation as 'absent' rather than numeric zero). Purpose: ensure explicit negative availability phrases ('no', 'none', 'not available') are normalized to numeric zero for quantity tags and mapped to the most specific availability tag. Rules:\n1) Negation cues (case-insensitive regex examples): /\\bno\\b/, /\\bnone\\b/, /\\bnot\\s+available\\b/, /\\bthere\\s+are\\s+no\\b/, /\\bzero\\b/ within ±6 tokens of an availability noun ('available', 'remain', 'remain\\s+available', 'available\\s+for\\s+grant').\n2) Quantity mapping: when negation cue co-occurs with availability noun and a plan/instrument anchor as applicable (e.g., 'under the Plan', 'under the facility'), assign numeric value 0 and map to the specific quantity tag (e.g., ShareBasedCompensationArrangementByShareBasedPaymentAwardNumberOfSharesAvailableForGrant = 0; LineOfCreditFacilityRemainingBorrowingCapacity = $0 when explicit 'amount available under the facility was $0' or 'no availability under the credit facility').\n3) Scope constraints (do NOT apply universal zero conversion): do not convert negations that apply to non-quantity facts or idiomatic phrases ('no material impact', 'no change', 'no further details'); require proximity to a numeric/quantity noun and an anchor.\n4) Tag-type constraint: only auto-convert to zero for quantity/amount-of-shares/remaining-capacity numeric tags; do not auto-convert percentages unless explicit context indicates 'zero percent' (e.g., 'no revenue' vs 'zero percent of revenue' are different; flag ambiguous percent-negations for review).\n5) Token-window & antecedent resolution: allow antecedent anchors in previous sentence up to ±1 sentence when anaphoric phrase 'the Plan'/'the facility' is used; require confidence threshold for cross-sentence negation mapping; otherwise flag for human review.\n6) Unit-tests/examples to add:\n   - 'no shares remain available under the 2014 Long Term Incentive Plan' -> ShareBasedCompensationArrangementByShareBasedPaymentAwardNumberOfSharesAvailableForGrant = 0.\n   - 'There are no amounts available under the credit facility' -> LineOfCreditFacilityRemainingBorrowingCapacity = 0.\n   - 'No material impact was expected' -> do NOT map to any numeric tag (must be filtered by scope constraint).\n7) Logging: any auto-zero assignment should be recorded with the negation cue span and the anchor span for traceability and QA.\n[err-00004] helpful=0 harmful=0 :: Anti-pattern prevention: Do not map currency amounts labeled as 'interest charges'/'interest expense' to generic InterestExpense when an instrument-anchor is present; instead map to InterestExpenseDebt and normalize explicit zeros. - Exact lexical cues (case-insensitive): /interest\\s+charge(s)?\\b/, /interest\\s+expense(s)?\\b/, /interest\\s+on\\s+the\\s+(note|notes|loan|term\\s+loan|seller\\s+note|revolver)/i. - Instrument-anchor detection: detect instrument names (Seller Notes, Term Loan, Revolver, Senior Notes, etc.) in same sentence OR previous sentence (allow antecedent resolution up to ±1 sentence and span <= 40 tokens). - Association window: currency numeric token within ±12 tokens of interest lexical cue (primary) and instrument-anchor within ±40 tokens across sentence boundary if needed. - Mapping rule: if both interest lexical cue and instrument-anchor present -> assign InterestExpenseDebt (link numeric to instrument id). If interest lexical cue present but no instrument-anchor -> assign generic InterestExpense and flag 'interest-amount-no-instrument' for review. - Zero/numeric normalization: if the numeric token is explicit 'zero', 'no interest', 'none' appearing within ±6 tokens of interest lexical cue and instrument-anchor present, normalize to numeric 0 and assign InterestExpenseDebt = 0; log negation cue span and anchor span for traceability. - Precedence: this instrument-specific mapping overrides any generic expense or cash-flow tag. - Unit-tests (atomic): - '$179,507 of interest charges associated with the Seller Notes for the year' -> $179,507 = InterestExpenseDebt (Seller Notes). - 'No interest expense was recorded on the Term Loan' -> InterestExpenseDebt = 0 (Term Loan), logged. - '$331,397 of interest expense for the six months ended June 30 related to the Term Loan' -> $331,397 = InterestExpenseDebt. - Logging: record instrument anchor span and interest phrase span for each mapping for QA and retraining; aggregate 'interest-amount-no-instrument' cases into review queue.\n[err-00007] helpful=0 harmful=0 :: [err-000XX] helpful=1 harmful=0 :: Explicit-measurement guard for customer-concentration percentage mappings (atomic prevention rule): - Purpose: Do NOT map a percentage token to any customer-concentration tag (including ConcentrationRiskPercentage1) unless the percentage is explicitly tied to a measurement that denotes a share (e.g., revenue, trade receivables). This prevents mis-mapping of margins, growth rates, tax rates, coupons, spreads, and other non-concentration percentages. - Positive measurement lexical cues (case-insensitive regexes): /\\bof\\s+(our|the|its|their)?\\s*(total\\s+net\\s+)?(revenue|revenues|sales|net\\s+revenue|total\\s+net\\s+revenue|consolidated\\s+revenue)\\b/, /accounted\\s+for\\s+(approximately|about|around)?\\s*[0-9]+(?:\\.[0-9]+)?\\s*%/, /represented\\s+(approximately|about)?\\s*[0-9]+(?:\\.[0-9]+)?\\s*%\\s+of\\s+(revenue|revenues)/, /%\\s+of\\s+(trade\\s+accounts\\s+receivable|accounts?\\s+receivable|receivables)\\b/, /%\\s+of\\s+our\\s+receivables\\b/. - Customer anchor detection (case-insensitive): /\\b(customer|customers|client|clients|the\\s+customer|the\\s+customers)\\b/, or a named-customer token (e.g., company names). Require either (A) measurement cue in same sentence near the percent OR (B) both a customer anchor and a measurement cue present within the association window. - Negative/ exclusion lexical cues (case-insensitive): do NOT map when percent co-occurs with: /\\bmargin|gross\\s+margin|operating\\s+margin|growth|increase|decrease|decline|change|rate|per\\s+annum|per\\s+year|statutory|tax|VAT|coupon|spread|basis|percent\\s+points\\b/. If any negative cue appears within ±6 tokens of the percent, block concentration mapping and evaluate other percentage-tag heuristics. - Association windows & antecedent resolution: primary window = ±10 tokens around the percent for measurement cues and customer anchors. Allow antecedent measurement/customer anchor in the immediately preceding sentence (±1 sentence) when anaphoric phrase ('the revenues', 'those receivables', 'our largest customer') is used and antecedent span <= 40 tokens; require explicit referential match before allowing cross-sentence mapping. - Precedence & decision flow (apply atomically before generic customer-percent -> ConcentrationRiskPercentage1): 1) If percent has a positive measurement cue (e.g., 'of revenue' or 'of trade accounts receivable') within ±10 tokens -> map to the measurement-specific concentration tag (revenue-specific or receivable-specific) if present in taxonomy; if none present, map to generic ConcentrationRiskPercentage1 but record fallback reason. 2) Else if percent is within ±10 tokens of a customer anchor AND a measurement cue exists in same sentence or allowed antecedent -> apply step (1). 3) Else if percent co-occurs with any negative/exclusion cue within ±6 tokens -> do NOT map to any concentration tag; continue other percentage-tag heuristics. 4) Else mark as 'concentration-measurement-ambiguous' and queue for human review (do NOT auto-map to concentration). - Unit-tests (atomic examples to add): 1) 'Our two largest customers accounted for approximately 44% of our revenues.' -> 44% = ConcentrationRiskPercentage1 (or revenue-specific tag). 2) 'Tech Data accounted for 7% of Autodesk\\'s total net revenue.' -> 7% = revenue-specific concentration tag. 3) 'Tech Data accounted for 5% of trade accounts receivable.' -> 5% = receivable-specific concentration tag. 4) 'Gross margin was 45% for the period.' -> 45% = NOT a concentration tag (should map to margin tag or flagged for other heuristics). 5) 'The tax rate was 21%.' -> 21% = tax-rate tag, NOT concentration. 6) 'The largest customer represented 22%.' -> ambiguous -> flag 'concentration-measurement-ambiguous' for review. - Logging & QA: always record percent token span, matched positive measurement cue span (if any), matched customer anchor span (if any), decision outcome (mapped-to-tag id OR blocked-with-reason OR queued-as-ambiguous), and taxonomy candidates considered. - Implementation note: insert this guard as the first step in the measurement-aware concentration mapping pipeline (before any default 'customer+percent -> ConcentrationRiskPercentage1' fallback) and add the unit-tests above to regression suites.\n[err-00009] helpful=0 harmful=0 :: err-000XX :: Transaction-direction guard for per-share prices (repurchase vs issuance) — atomic prevention rule: Purpose: Always resolve transaction direction before mapping any 'price per share' token. Exact repurchase/treasury lexical cues (case-insensitive regexes): /\\b(repurchas(?:e|ed)|bought\\s+back|acquired\\s+for\\s+treasury|acquired\\s+treasury\\s+stock|treasury\\s+stock|shares\\s+repurchased)\\b/. Exact issuance/sale lexical cues (case-insensitive regexes): /\\b(issued|sold|offered|sale\\s+of|proceeds\\s+from\\s+sale|sold\\s+on\\s+the\\s+market|underwriter(s)?|offering)\\b/. Association window: apply cue detection to the same sentence as the numeric token and the nearest ±8 tokens; allow antecedent anchor in the previous sentence when anaphora ('the shares', 'the repurchase program') is used and antecedent span <= 40 tokens. 'Average' qualifier detection: detect /\\baverage\\s+price|average\\s+cost\\b/ within ±4 tokens of the per-share numeric to disambiguate average-cost phrases. Precedence mapping (apply atomically): 1) If any repurchase/treasury cue matches within the association window -> map per-share price tokens to TreasuryStockAcquiredAverageCostPerShare; map aggregate/total currency amounts associated with the repurchase verb to TreasuryStockValueAcquiredCostMethod. 2) Else if any issuance/sale cue matches within the window -> map per-share price tokens to SaleOfStockPricePerShare (or issuance-price tag if more specific issuance tag exists). 3) If both repurchase and issuance cues appear in the same sentence or adjacent sentences and both are within tie-window (token-distance difference <= 3 tokens) -> do NOT auto-assign; flag as 'transaction-direction-conflict' and queue for human review. Tie-breaker: if 'average' qualifier co-occurs with repurchase cues, prefer TreasuryStockAcquiredAverageCostPerShare even if a generic 'price' or 'sold' token appears elsewhere in sentence. Unit-tests (atomic examples to add): - 'repurchased 70,783 shares at an average price of $15.09' -> $15.09 = TreasuryStockAcquiredAverageCostPerShare; 70,783 shares = TreasuryStockNumberOfSharesAcquired (if such tag exists) or link shares to repurchase event. - 'we sold 70,783 shares at an average price of $15.09' -> $15.09 = SaleOfStockPricePerShare. - 'the company repurchased shares for an aggregate of $1.1 million' -> $1.1M = TreasuryStockValueAcquiredCostMethod. - 'we issued 100,000 shares at $10.00 per share' -> $10.00 = SaleOfStockPricePerShare or issuance-specific price tag. Logging & QA: record matched cue spans (repurchase vs issuance), numeric span, 'average' qualifier span if any, chosen tag id, and conflict reason when flagged. Implementation note: insert this guard as the first step in any per-share price tagging pipeline (before generic 'per share' -> SaleOfStockPricePerShare fallback and before instrument-type heuristics) so transaction direction deterministically overrides generic price mapping.\n## PROBLEM-SOLVING HEURISTICS\n\n[ph-00006] helpful=0 harmful=0 :: Delta decision flow (apply in order for each numeric token): 1) Sentence-level scan: detect instrument-type cues (convertible/preferred/mandatory) and offering cues (underwriters, overallotment, offering language) across the sentence ±1 surrounding sentence. 2) If instrument-type == convertible: - If numeric token is a price or appears adjacent to unit tokens like 'per share', 'per common share', 'per depositary share': assign DebtInstrumentConvertibleConversionPrice1 unless an explicit secondary-market sale cue is present. - If numeric token is shares and offering cues present: assign StockIssuedDuringPeriodSharesNewIssues. 3) If offering cues present (even if instrument-type absent): - If numeric token is number-of-shares -> assign StockIssuedDuringPeriodSharesNewIssues (primary issuance). - If numeric token is price and context uses 'offering price', 'issued at', 'offering at' -> prefer issuance-price tag (if available) else flag for review. 4) If no instrument-type or offering cues: use existing lexical-to-tag mapping (e.g., 'sold' -> SaleOfStockNumberOfSharesIssuedInTransaction) as fallback. 5) Tie-breaker precedence (high -> low): instrument-specific issuance tags (convertible conversion price, mandatory-convertible issuance) > issuance/share-specific tags (StockIssuedDuringPeriodSharesNewIssues) > generic sale tags (SaleOfStock*). 6) Ambiguity handling: if fallback mapping would assign a generic sale tag but any instrument/offering cue matched (score difference < threshold), flag the example and record sentence+reason for human review and training. 7) Unit-test generation examples to add to test suite: - \"We sold 17,250,000 shares, including the underwriters' exercise of the overallotment option\" -> 17,250,000 = StockIssuedDuringPeriodSharesNewIssues. - \"Sempra Energy 6% Mandatory Convertible Preferred Stock, Series A, was issued at $100.00 per share\" -> $100.00 = DebtInstrumentConvertibleConversionPrice1. - \"We sold 500,000 shares on the open market\" -> 500,000 = SaleOfStockNumberOfSharesIssuedInTransaction.\n[ph-00004] helpful=0 harmful=0 :: Tax-rate decision-flow delta (atomic): - Insert as a first-order step for percentage tokens: 1) For each percentage token, first scan for tax-rate measurement-terms in the same sentence or immediate noun phrase: lexical cues include 'statutory', 'federal', 'U.S.', 'corporate federal income tax rate', 'statutory income tax rate'. 2) If any statutory/federal tax cue matches within ±4 tokens (or forms a grammatical 'rate of X%' phrase), assign EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate and stop further percentage-tag heuristics. 3) If multiple percentage tags remain plausible (e.g., 'effective tax rate' vs 'statutory rate'), prefer the most specific reconciliation/statutory tag when the statutory/federal cue is present. 4) If jurisdiction qualifiers exist (state/local/foreign) prefer the jurisdiction-specific statutory tag if available; otherwise flag as 'jurisdictional-tax-ambiguous' for review. 5) If no statutory/federal cue is found, continue the existing percentage mapping flow. 6) Add a unit-test batch to assert that any percent explicitly labeled 'statutory'/'U.S. statutory'/'federal statutory' is consistently mapped to EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate and logged when multiple jurisdiction cues exist.\n## CONTEXT CLUES & INDICATORS\n\n[ctx-00001] helpful=0 harmful=0 :: Lexical-to-tag mapping (exact cues + variants). Use exact phrase detection before higher-level semantic heuristics. Patterns to detect (case-insensitive): - 'purchase price', 'total purchase price', 'aggregate purchase price' -> tag PaymentsToAcquireBusinessesGross. Regex examples: /(?:aggregate\\s+|total\\s+)?purchase\\s+price/i. - 'consideration', 'consideration transferred', 'aggregate consideration' -> tag BusinessCombinationConsiderationTransferred1. Regex examples: /(?:aggregate\\s+)?consideration(?:\\s+transferred)?/i. - 'cash paid', 'cash consideration', 'cash consideration paid' -> PaymentsToAcquireBusinessesGross. Regex: /cash(?:\\s+consideration)?\\s+paid/i. - 'shares issued', 'shares were issued', 'issued X shares' -> BusinessAcquisitionEquityInterestsIssuedOrIssuableNumberOfSharesIssued. Regex: /(?:issued|issued\\s+approximately)\\s+\\d+[\\d,]*(?:\\s+shares)?/i. Apply these matches to the phrase window that contains the numeric amount (±8 tokens) to ensure the amount belongs to the detected cue.\n[ctx-00005] helpful=1 harmful=0 :: Instrument-type detection patterns (case-insensitive regexes and token cues): - Convertible indicators: /\\bconvertible\\b/, /\\bconversion price\\b/, /\\bconversion cap\\b/, /\\bconvertible preferred\\b/, /\\bmandatory convertible\\b/, /\\bmandatory convertible preferred\\b/. - Preferred-stock signals: /\\bpreferred stock\\b/, /\\bseries [A-Z]+\\b/, /\\bdividend(?:-bearing)?\\b/. - Debt-like convertible signals: /\\b6% mandatory convertible preferred stock\\b/ (literal patterns for numerated series acceptable). Offering / primary-issuance indicators: - underwriters: /\\bunderwriter(s)?\\b/, /\\bwe sold\\b/, /boffering\\b/, /\\boverallotment\\b/, /\\bexercise[d]?\\s+overallotment\\b/, /\\bprimary offering\\b/, /\\boffered and sold\\b/, /\\bpurchased by the underwriters\\b/. Sale / secondary-market indicators (inverse cues): /\\bwe sold to third parties\\b/, /\\bsecondary offering\\b/, /\\btraded on\\b/, /\\bsold on the market\\b/. Numeric association window policy: - Primary association window = ±8 tokens around numeric token. - If an instrument-type cue appears anywhere in the same sentence, treat instrument-type as global for that numeric token (i.e., instrument cues outrank local lexical matches within window). - If offering cue appears in same sentence or adjacent sentence (±1 sentence), mark transaction as primary issuance. Precedence mapping rules (applied after detection): - If instrument-type == convertible AND numeric_context == price -> map numeric to DebtInstrumentConvertibleConversionPrice1 (convertible conversion/issuance price). - If offering_flag == true AND numeric_context == shares -> map numeric to StockIssuedDuringPeriodSharesNewIssues. - If instrument-type == convertible AND offering_flag == true AND numeric_context == shares -> StockIssuedDuringPeriodSharesNewIssues (shares issued in offering of convertible instrument). - Only if no instrument-type OR offering cues detected, or if explicit secondary-sale cues present, fall back to SaleOfStockNumberOfSharesIssuedInTransaction / SaleOfStockPricePerShare. Distance weighting: - When multiple cues present, compute score = (instrument_cue_present ? 10 : 0) + (offering_cue_present ? 8 : 0) + (1 / (1 + token_distance_to_numeric)). Choose tag with highest score. Logging: - If generic sale tag would be selected but instrument-type OR offering cues exist with nonzero score, log for human review and mark as 'contextual-overlap' example for retraining.\n[ctx-00008] helpful=0 harmful=0 :: Credit-facility vs spread disambiguation (atomic heuristics):\n1) Purpose: ensure currency amounts describing facility capacity map to LineOfCreditFacilityMaximumBorrowingCapacity and percentage 'margin/spread' phrases over LIBOR/ABR map to DebtInstrumentBasisSpreadOnVariableRate1.\n2) Exact lexical cues (case-insensitive):\n   - Facility-capacity cues (map currency -> LineOfCreditFacilityMaximumBorrowingCapacity): /\\b(revolv(?:ing)?\\s+credit\\s+facilit(?:y|ies)|credit\\s+facility|revolver)\\b/, /\\bin\\s+an\\s+aggregate\\s+principal\\s+amount\\b/, /\\b(up\\s+to)\\b/, /\\bmaximum\\s+amount\\b/, /\\bcommitment\\b/.\n   - Outstanding/borrowings cues (do NOT map to capacity): /\\boutstanding\\b/, /\\bborrowed\\b/, /\\bamounts?\\s+outstanding\\b/, /\\bprincipal\\s+amounts?\\s+outstanding\\b/.\n   - Spread/margin cues (map percentage -> DebtInstrumentBasisSpreadOnVariableRate1): /\\bmargin(s)?\\b/, /\\bspread(s)?\\b/, /\\bover\\s+(?:LIBOR|ABR|an?\\s+index)\\b/, /\\bin\\s+the\\s+case\\s+of\\s+(?:LIBOR|ABR)\\s+loan(s)?\\b/.\n   - Absolute/effective-rate cues (do NOT map to spread): /\\binterest\\s+rate\\b/, /\\beffective\\s+rate\\b/, /\\bper annum\\b/, /\\bAPR\\b/.\n3) Token association window policy: apply matches to numeric tokens using a ±8-token window for lexical cues and ±1 sentence for facility-level cues (e.g., named facility in prior sentence). If a facility-capacity cue appears anywhere in the same sentence or the immediately preceding sentence, currency amounts within ±16 tokens of that cue are capacity candidates.\n4) Precedence rules (apply in order):\n   a) If numeric is currency AND a facility-capacity cue matches (within window) -> assign LineOfCreditFacilityMaximumBorrowingCapacity.\n   b) If numeric is currency AND an outstanding/borrowings cue matches -> assign outstanding-balance tag (do not map to capacity).\n   c) If numeric is a percentage AND a spread/margin cue matches (within ±3 tokens) AND the phrase references LIBOR/ABR/index -> assign DebtInstrumentBasisSpreadOnVariableRate1.\n   d) If numeric is a percentage AND absolute/effective-rate cues match (within ±3 tokens) -> assign the appropriate interest-rate tag (do NOT map to basis/spread); if no interest-rate tag exists in taxonomy, flag for human review rather than mapping to spread.\n   e) If a conflict exists (e.g., 'margin' and 'interest rate' both present), prefer the more specific cue: 'margin/spread over LIBOR/ABR' > 'interest rate' only when text explicitly says 'margin' or 'spread'; otherwise prefer 'interest rate' mapping.\n5) Normalization and token checks:\n   - Recognize percentages with % or the word 'percent' or numeric forms like '1.00%–2.00%'.\n   - Recognize currency with $ or currency words (dollars, EUR, etc.).\n6) Logging & QA:\n   - If mapping would assign a spread tag but the sentence contains 'interest rate'/'per annum' within ±3 tokens of the percentage, log as 'potential-rate-vs-spread' for human review and add to targeted unit-tests.\n7) Minimal unit-tests to add (atomic examples):\n   - \"revolving credit facilities in an aggregate principal amount of up to $225.0 million\" -> $225.0 million = LineOfCreditFacilityMaximumBorrowingCapacity.\n   - \"The margin ranges from 1.00% to 2.00% in the case of LIBOR loans\" -> 1.00% and 2.00% = DebtInstrumentBasisSpreadOnVariableRate1.\n   - \"The interest rate is 5.00% per annum\" -> 5.00% = interest-rate tag (do NOT map to DebtInstrumentBasisSpreadOnVariableRate1); if interest-rate tag missing, flag for review.\n   - \"$50 million outstanding under the revolver\" -> $50 million = outstanding-balance tag (do NOT map to capacity).\n8) Implementation notes (for classifiers / regex pipelines):\n   - Apply these patterns before generic lexical-to-tag fallbacks.\n   - When multiple tags are plausible, compute priority score where facility-capacity cue adds +10, outstanding cue +12 (to avoid mis-tagging as capacity), spread/margin +10, interest-rate cue +11; choose highest score and log ties.\n   - Add examples that mix LIBOR/ABR and 'margin' with numeric ranges to training/regression suites to prevent collapse into absolute-rate tags.\n[ctx-00009] helpful=0 harmful=0 :: Credit-facility availability vs capacity — atomic disambiguation rule (apply before generic 'availability' fallback):\n1) Purpose: ensure currency amounts that reference facility size/capacity map to LineOfCreditFacilityMaximumBorrowingCapacity and only map to LineOfCreditFacilityRemainingBorrowingCapacity when the sentence explicitly reports a point-in-time available amount.\n2) Exact lexical patterns (case-insensitive regexes):\n   - Facility-capacity anchor (detect stated cap): /(?:has|has a|has an|in an aggregate principal amount of|in an aggregate amount of|in an aggregate principal amount of up to|up to)\\s+\\$?[\\d,]+(?:\\.\\d+)?\\s*(?:million|billion)?\\s*(?:revolv(?:ing)?\\s+credit\\s+facilit(?:y|ies)|credit\\s+facility|revolver)/i\n   - Explicit remaining-amount cues (map to remaining borrowing capacity): /(?:amount available under the (?:credit )?facility(?: totaled|was|is)|available under the facility totaled|was available under the facility|amount available under the facility is)\\b/i\n   - Comparative/constraint cues (signal comparison to a stated cap): /availability\\s+(?:under|of)\\s+(?:this|the)?\\s*(?:credit )?facilit(?:y|ies)\\s+may\\s+be\\s+less\\s+than\\s+\\$?[\\d,]+(?:\\.\\d+)?/i, /may\\s+be\\s+less\\s+than\\b/i, /as\\s+a\\s+result\\s+of\\b/i, /for\\s+certain\\s+subsidiaries\\b/i, /for\\s+specific\\s+entities\\b/i\n3) Association windows and antecedent resolution:\n   - If a facility-capacity anchor (pattern above) appears anywhere in the same sentence OR in the immediately preceding sentence, consider that dollar amount the canonical facility maximum for subsequent comparative/availability clauses. (Sentence window = ±1 sentence.)\n   - Token association: when anchored, allow currency amounts in comparative clauses up to ±16 tokens from the comparative phrase to be treated as referencing the stated cap.\n4) Precedence decision flow (apply in order):\n   a) If numeric is currency AND explicit remaining-amount cues match (within ±8 tokens) -> assign LineOfCreditFacilityRemainingBorrowingCapacity.\n   b) Else if numeric is currency AND comparative/constraint cue matches (e.g., \"availability may be less than $X\") AND X equals the earlier-detected facility-capacity anchor amount (or the sentence contains a nearby explicit facility-capacity anchor) -> assign LineOfCreditFacilityMaximumBorrowingCapacity (the phrase is comparing to the contractual cap or describing effective cap reductions).\n   c) Else if numeric is currency AND comparative/constraint cue matches BUT no prior anchor exists: if clause contains constraint markers ('as a result of', 'for certain subsidiaries', 'for specific entities', 'may be less than') prefer MaximumBorrowingCapacity (treat as described cap limit) but mark as 'ambiguous-availability-without-anchor' and log for review.\n   d) Else if numeric is currency AND no comparative/anchor cues but lexical 'availability' appears alone (no 'amount available', no 'totaled') -> treat as ambiguous: do NOT auto-assign RemainingBorrowingCapacity; instead prefer MaximumBorrowingCapacity only if a facility-capacity anchor exists in same or previous sentence; otherwise flag for human review.\n5) Tie-breaker and override: facility-capacity anchor presence overrides the naive 'availability -> remaining' rule. Explicit remaining-amount lexical patterns override capacity mapping and must map to RemainingBorrowingCapacity regardless of anchors.\n6) Examples / unit-tests (add to targeted suite):\n   - \"The Company has a $75 million revolving credit facility (credit facility)\" -> $75 million = LineOfCreditFacilityMaximumBorrowingCapacity.\n   - \"availability under this credit facility may be less than $75 million as a result of outstanding letters of credit...\" -> $75 million = LineOfCreditFacilityMaximumBorrowingCapacity (because X matches stated cap and clause is comparative/constraint).\n   - \"an outstanding letter of credit under the credit facility totaled $12.5 million and the amount available under the facility totaled $62.5 million\" -> $12.5M = LettersOfCreditOutstandingAmount; $62.5M = LineOfCreditFacilityRemainingBorrowingCapacity (explicit remaining-amount cue).\n   - \"availability under the facility may be less than $40 million\" (no prior stated cap mentioned) -> flag 'ambiguous-availability-without-anchor' and queue for human review (do not auto-assign RemainingBorrowingCapacity).\n7) Logging & QA: any case where 'availability' appears but the rule chooses MaximumBorrowingCapacity only because of an antecedent anchor must be logged as 'availability-referenced-cap' with the anchor span and numeric comparison; ambiguous/no-anchor cases must be logged as 'ambiguous-availability' and added to training data.\n8) Implementation notes: incorporate these checks before any generic lexical mapping that equates 'availability' -> remaining capacity; add unit-tests above and regressions that ensure 'amount available' still maps to RemainingBorrowingCapacity.\n[ctx-00011] helpful=0 harmful=0 :: Interest-rate 'per annum' -> DebtInstrumentInterestRateStatedPercentage (atomic heuristic): - Purpose: map percentages expressed as annual/stated interest rates on named debt instruments to DebtInstrumentInterestRateStatedPercentage. - Exact lexical cues (case-insensitive regexes): /(per\\s+annum|per\\s+year|annually|annual\\s+rate|%\\s+per\\s+annum|APR)\\b/ and instrument anchors: /\\b(note|notes|loan|loans|seller\\s+note|senior\\s+notes|term\\s+loan|revolver|debt\\b)/i. - Association window: require both a percentage token and at least one instrument-anchor token in the same sentence OR instrument-anchor within the previous sentence (±1 sentence). If instrument name present in same sentence, require token-distance <= 12 tokens; if in prior sentence, allow <= 40 token span across sentence boundary. - Precedence: If 'per annum' (or equivalent) is detected within ±3 tokens of the percentage, prefer DebtInstrumentInterestRateStatedPercentage over spread/basis tags. - Conflict rule: If both 'margin'/'spread' cues and 'per annum' cues are present, prefer 'per annum' -> stated-rate mapping, but log as 'rate-vs-spread-conflict' for QA. - Unit-tests/examples: - \"8% per annum on the Seller Notes\" -> 8% = DebtInstrumentInterestRateStatedPercentage (anchor 'Seller Notes'). - \"The interest rate is 5.00% per year on the term loan\" -> 5.00% = DebtInstrumentInterestRateStatedPercentage. - Implementation note: apply before generic percentage-to-spread fallbacks.\n[ctx-00012] helpful=0 harmful=0 :: Monetary 'interest charges' mapping to instrument-specific InterestExpenseDebt (atomic heuristic): - Purpose: ensure currency amounts described as interest charges/interest expense tied to a particular note/loan map to InterestExpenseDebt (and are linked to the instrument identity) rather than a generic InterestExpense tag. - Exact lexical cues (case-insensitive regexes): /interest\\s+charge(s)?\\b/, /interest\\s+expense(s)?\\b/, /interest\\s+cost(s)?\\b/, /(interest\\s+charges)\\s+associated\\s+with/, /interest\\s+relating\\s+to/, /interest\\s+on\\s+the\\s+(?:note|notes|loan|loan\\s+agreement)/i. - Association policy: require a currency token (e.g., $179,507) in same sentence and an instrument anchor (note/loan name like 'Seller Notes') in same sentence OR previous sentence. Primary token-distance window = ±12 tokens around numeric; allow ±1 sentence antecedent resolution with span <= 40 tokens. - Precedence: instrument-specific InterestExpenseDebt overrides generic InterestExpense when instrument anchor present. If instrument anchor not present, map to generic InterestExpense and flag 'interest-amount-no-instrument' for review. - Unit-tests/examples: - \"$179,507 of interest charges associated with the Seller Notes for the year\" -> $179,507 = InterestExpenseDebt (linked to Seller Notes). - \"$331,397 of interest expense for the six months ended June 30 related to the Term Loan\" -> $331,397 = InterestExpenseDebt. - Logging: record sentence span and instrument anchor for any instrument-linked interest mapping for traceability.\n[ctx-00013] helpful=1 harmful=0 :: Customer-concentration percentage mapping -> ConcentrationRiskPercentage1 (atomic heuristic): - Purpose: map percentages that quantify customer concentration of revenues to ConcentrationRiskPercentage1. - Exact lexical cues/patterns (case-insensitive regexes): /(?:two|three|top|largest|the\\s+two\\s+largest|the\\s+largest)\\s+customers\\b/, /customer\\s+concentration\\b/, /accounts?\\s+for\\s+about|accounted\\s+for\\s+approximately|accounted\\s+for\\s+|represent(s|ed)\\s+approximately\\s+\\d+\\%/i. Percentage capture window: detect percentage token within ±10 tokens of customer/revenue cue and/or the phrase 'of (our|the)? revenues' or 'of revenue'. - Precedence: when percentage is explicitly tied to 'customers' + 'revenues', map to ConcentrationRiskPercentage1 even if other percentage-tag candidates exist. - Unit-tests/examples: - \"Our two largest customers accounted for approximately 44% of our revenues\" -> 44% = ConcentrationRiskPercentage1. - \"The largest customer represented 22% of revenue\" -> 22% = ConcentrationRiskPercentage1. - Ambiguity handling: if percent lacks 'customer' anchor but 'of revenues' alone appears, mark as potential concentration and log for human review.\n[ctx-00001] helpful=0 harmful=0 :: Equity / Plan lexical-to-tag atomic rules (exact cues + variants). Purpose: deterministically map par-value, shares-outstanding, plan-availability and plan-authorized numeric tokens to the most specific US GAAP tag. Rules (apply in order):\n1) Par/Stated value per share -> CommonStockParOrStatedValuePerShare\n   - Exact lexical cues (case-insensitive regex examples): /\\$?\\s*[0-9]{1,3}(?:[\\,\\d]*)(?:\\.\\d+)?\\s*(?:per|par)\\s+share(s)?\\b/, /par\\s+value\\s+of\\s+\\$?\\s*[0-9.,]+\\b/, /stated\\s+value\\s+per\\s+share\\b/.\n   - Association window: numeric token and 'per share'/'par value' cue must co-occur in the same sentence and lie within ±8 tokens.\n   - Precedence: if matched, assign CommonStockParOrStatedValuePerShare regardless of other nearby 'price' or 'per share' generic sale cues.\n   - Unit-tests: '$0.001 par value per share' -> CommonStockParOrStatedValuePerShare = 0.001; 'stated value per common share of $0.01' -> CommonStockParOrStatedValuePerShare = 0.01.\n\n2) 'Shares outstanding' -> CommonStockSharesOutstanding\n   - Exact lexical cues: /shares\\s+outstanding\\b/, /outstanding\\s+shares\\b/, /shares\\s+were\\s+outstanding\\b/.\n   - Association window: numeric token within ±8 tokens of the cue; sentence-level anchor required.\n   - Precedence: this tag wins over generic 'shares issued' or offering tags when 'outstanding' is present and no offering/underwriter cues are present in ±1 sentence.\n   - Unit-tests: '28,026,713 shares outstanding' -> CommonStockSharesOutstanding = 28,026,713.\n\n3) Plan context: map plan-specific share counts to plan tags\n   - Plan-anchor detection (case-insensitive): /(?:long[- ]term incentive plan|2014\\s+Long\\s+Term\\s+Incentive\\s+Plan|LTIP|stock\\s+plan|equity\\s+compensation\\s+plan)\\b/ (allow named-year or 'the Plan' with antecedent resolution from prior sentence).\n   - If plan-anchor present in same sentence OR immediately preceding sentence (±1 sentence) then apply plan-specific mappings:\n     a) 'available'/'remain available' -> ShareBasedCompensationArrangementByShareBasedPaymentAwardNumberOfSharesAvailableForGrant\n        - Cues: /available\\s+.*?shares|remain\\s+available|shares\\s+available\\s+for\\s+grant\\b/; numeric token within ±8 tokens maps to that tag.\n     b) 'maximum number' / 'may be delivered' / 'authorized' -> ShareBasedCompensationArrangementByShareBasedPaymentAwardNumberOfSharesAuthorized\n        - Cues: /maximum\\s+number\\s+of\\s+shares|may\\s+be\\s+delivered\\s+.*?is\\s+\\$?\\s*[\\d,]+|authorized\\s+to\\s+issue\\s+up\\s+to\\s+\\$?\\s*[\\d,]+\\b/, numeric token maps to Authorized tag.\n   - Token association: allow antecedent plan-name in previous sentence when 'the Plan' or year-named plan is used; antecedent span <= 40 tokens across sentence boundary.\n   - Precedence: plan-specific tags override generic share tags (e.g., StockIssuedDuringPeriodSharesNewIssues, SaleOfStockNumberOfSharesIssuedInTransaction) whenever the plan-anchor is detected.\n   - Unit-tests: 'no shares remain available under the 2014 Long Term Incentive Plan' -> ShareBasedCompensationArrangementByShareBasedPaymentAwardNumberOfSharesAvailableForGrant = 0; 'maximum number of shares that may be delivered under the plan is 15,000,000' -> ShareBasedCompensationArrangementByShareBasedPaymentAwardNumberOfSharesAuthorized = 15,000,000.\n\n4) Association & ambiguity handling\n   - If both a plan-anchor and offering/underwriter cues are present, prefer plan-specific mappings for availability/authorized fields and issuance-specific mappings for issuance events; log any example where plan-anchor and issuance-anchor both score >0 as 'plan-vs-issuance-overlap' for human review.\n   - If no plan-anchor is found but text uses 'available under the plan' with an antecedent plan name earlier in document >1 sentence away, require human-review flag (do not auto-assign) unless antecedent resolution confidence >= threshold.\n\n5) Implementation notes\n   - Apply these rules before generic 'per share' or 'shares' fallbacks; add unit-tests above and log 'plan-availability-zero' cases for QA traceability.\n[ctx-00003] helpful=0 harmful=0 :: Atomic rule: Map 'LIBOR plus X%' (and close variants) -> DebtInstrumentBasisSpreadOnVariableRate1. - Purpose: avoid misinterpreting 'LIBOR plus X%' as an absolute stated interest rate. - Exact lexical patterns (case-insensitive regexes): /(LIBOR|ABR|an? index)\\s*(?:\\+|plus|\\+/-|\\band\\s+an?\\s+adjusted\\s+rate|with\\s+a\\s+margin\\s+of)\\s*([0-9]+(?:\\.[0-9]+)?\\s*%)/i and /(?:margin|spread)\\s*(?:of)?\\s*([0-9]+(?:\\.[0-9]+)?\\s*%)\\s*(?:over|above|to|on)\\s*(LIBOR|ABR|index)/i. - Token association: require percentage token within ±3 tokens of LIBOR/ABR or 'plus'/'over' lexical cue; allow antecedent instrument references in same sentence or previous sentence ±1 if needed for linking. - Precedence/tie-breaker: If both 'per annum'/'per year'/'annual' occurs within ±3 tokens of the percentage, prefer DebtInstrumentInterestRateStatedPercentage only if there is explicit 'per annum' + instrument-anchor; otherwise prefer DebtInstrumentBasisSpreadOnVariableRate1 for 'LIBOR plus X%' forms. - Unit-tests (atomic examples): - 'LIBOR plus 4.15%' -> 4.15% = DebtInstrumentBasisSpreadOnVariableRate1. - 'the margin ranges from 1.00% to 2.00% in the case of LIBOR loans' -> both percents = DebtInstrumentBasisSpreadOnVariableRate1. - 'interest rate of 4.15% per annum' -> 4.15% = DebtInstrumentInterestRateStatedPercentage (not a spread). - Logging: any mapping where both 'margin/spread' and 'per annum' cues are within ±3 tokens should be logged as 'rate-vs-spread-conflict' with spans for QA and unit-test augmentation. - Implementation note: apply this rule before generic percentage-to-interest fallbacks and add targeted regression tests for 'plus/over' surface forms.\n[ctx-00005] helpful=1 harmful=0 :: Atomic lexical rule: map 'borrowing base' -> LineOfCreditFacilityRemainingBorrowingCapacity (alias: LineOfCreditFacilityCurrentBorrowingCapacity).\n- Exact lexical cues (case-insensitive regexes): /\\bborrowing\\s+base\\b/, /\\bamount(?:s)?\\s+available\\s+to\\s+borrow\\b/, /\\bavailable\\s+borrowing\\s+capacity\\b/, /\\bamount\\s+available\\s+under\\s+the\\s+(?:credit\\s+)?facility\\b/.\n- Association window: numeric token must lie within ±8 tokens of the cue in the same sentence; allow antecedent plan/facility name resolution in previous sentence (±1 sentence) if anchor span <= 40 tokens.\n- Precedence rules (apply in order):\n  1) If a cue above matches -> assign LineOfCreditFacilityRemainingBorrowingCapacity for the nearest numeric currency token (override generic 'capacity' or 'availability' fallbacks).\n  2) If the same sentence explicitly contains 'maximum', 'commitment', 'up to', 'in an aggregate principal amount of', or similar contractual-cap cues within ±8 tokens of a different currency token -> assign those tokens to LineOfCreditFacilityMaximumBorrowingCapacity (do NOT remap borrows labeled explicitly as 'maximum').\n  3) If a single sentence contains both a 'borrowing base' cue and a 'maximum/commitment' cue with two different currency tokens, map each numeric to the cue it is adjacent to (token-distance); if one numeric token is within distance of both cues, prefer the 'borrowing base' -> RemainingBorrowingCapacity mapping for that numeric and log as 'borrowbase-vs-commitment-conflict'.\n  4) If only the word 'capacity' or 'availability' appears without an explicit 'borrowing base' or 'amount available' phrasing, defer to existing availability-vs-capacity rules (ctx-00009 / err-00010) and require anchor-checks; do NOT treat 'capacity' alone as proof of remaining-amount.\n- Ambiguity handling: if 'borrowing base' appears but no numeric token in ±8 tokens, flag 'borrowing-base-no-amount' for review (do not guess). If numeric present but sentence contains conflicting language (e.g., 'borrowing base' and 'maximum' both adjacent to the same numeric), map to RemainingBorrowingCapacity and log conflict for QA.\n- Unit-tests (atomic examples to add):\n  - \"The borrowing base under the credit facility is $425.0 million.\" -> $425.0M = LineOfCreditFacilityRemainingBorrowingCapacity.\n  - \"An amount available under the facility totaled $62.5 million\" -> $62.5M = LineOfCreditFacilityRemainingBorrowingCapacity.\n  - \"Revolving credit facility in an aggregate principal amount of up to $225.0 million; the borrowing base available is $150.0 million\" -> $225.0M = LineOfCreditFacilityMaximumBorrowingCapacity; $150.0M = LineOfCreditFacilityRemainingBorrowingCapacity.\n  - \"Availability under this credit facility may be less than $75 million as a result of outstanding letters of credit\" (and $75M equals prior stated cap) -> follow comparative-rule in ctx-00009 (map to MaximumBorrowingCapacity), but if 'borrowing base' is used instead of 'availability' and tied to $75M map to RemainingBorrowingCapacity.\n- Logging & QA: record mapping span with label 'borrowing-base-mapped' including cue span, numeric span, and antecedent facility anchor. Add 'borrowbase-vs-commitment-conflict' and 'borrowing-base-no-amount' to review queues for retraining.\n[ctx-00001] helpful=0 harmful=0 :: Atomic lexical-first heuristic: Distinguish 'GrantsInPeriod' vs 'NonvestedNumber' for share-based compensation counts.\n- Purpose: Prevent inferring 'nonvested' from mentions of vesting/performance conditions when the text explicitly states a grant count for a reporting period.\n- Exact grant lexical cues (case-insensitive regexes; match within same sentence): /\\b(grants?\\s+(for|during|issued\\s+(during|in))|granted\\s+(during|for)|included\\s+in\\s+the\\s+rsu\\s+grants|included\\s+in\\s+the\\s+grants)\\b/i and variants (e.g., 'awards granted during', 'grants for the [period]', 'granted during the [period]'). When such a pattern occurs and a numeric token is within ±8 tokens of the matched phrase, assign ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsGrantsInPeriod.\n- Exact nonvested lexical cues (case-insensitive regexes): /\\b(non-?vested|unvested|awards?\\s+(?:outstanding\\s+and\\s+unvested|outstanding and unvested|outstanding,? unvested)|shares?\\s+unvested)\\b/i. Only assign ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsNonvestedNumber when one of these cues occurs and the numeric token is within ±8 tokens of the nonvested cue.\n- Vesting/performance-criteria safeguard: phrases mentioning 'performance criteria', 'vesting conditions', 'three-year service criteria', 'will vest' etc. (regex examples: /\\b(performance\\s+criteria|vesting|vest|service\\s+criteria)\\b/i) must NOT by themselves trigger NonvestedNumber. Treat these as neutral modifiers unless explicit nonvested/unvested language appears close to the numeric. Do NOT map to NonvestedNumber solely because vesting conditions are described.\n- Token-distance & precedence tie-breaker (apply in order):\n  1) If both a grant-cue and a nonvested-cue are present in the sentence, compute token-distance from numeric to each cue span. Assign the tag associated with the nearest cue.\n  2) If distances are equal or ambiguous, prefer explicit 'grants' mapping (GrantsInPeriod) over NonvestedNumber unless the nonvested phrase is an explicit outstanding/unvested anchor (e.g., 'outstanding and unvested X RSUs').\n  3) If only vesting/performance cues exist (no explicit 'grants' or 'nonvested' cues in ±8 tokens), map to GrantsInPeriod only if an explicit grant-verb phrase exists elsewhere in same clause/sentence (±1 clause). Otherwise flag as 'ambiguous-grant-vs-nonvested' for human review rather than auto-assign NonvestedNumber.\n- Association window & antecedent resolution: allow antecedent grant-anchor ('the RSU grants' / 'the Plan') in previous sentence (±1 sentence) when anaphoric referent is used, but require antecedent span <= 40 tokens and the numeric must still be within ±16 tokens of the antecedent mention to auto-map. If antecedent resolution confidence is low, flag for review.\n- Unit-tests (atomic examples to add):\n  • \"Included in the RSU grants for the nine months ended September 30, 2018, are approximately 71,000 RSUs\" -> 71,000 = GrantsInPeriod.\n  • \"Approximately 71,000 RSUs were granted during the year\" -> 71,000 = GrantsInPeriod.\n  • \"Approximately 71,000 RSUs remain unvested and outstanding\" -> 71,000 = NonvestedNumber.\n  • \"Included in the grants are performance-vesting RSUs totaling 71,000\" -> 71,000 = GrantsInPeriod (do not infer NonvestedNumber from 'performance-vesting').\n- Logging & QA: when a mapping decision involves both grant- and vesting-related cues, log the numeric span, grant-cue span, vesting-cue span, chosen tag, and token-distance scores. Add any auto-mapped cases where only vesting/performance cues existed and mapping was attempted to a 'ambiguous-grant-vs-nonvested' queue for human review and model retraining.\n- Implementation note: apply this heuristic before any semantic-classifier fallback that infers outstanding/nonvested counts from vesting language. Explicit lexical matches for 'grants' must win unless a stronger explicit nonvested anchor is nearer to the numeric.\n[ctx-00002] helpful=0 harmful=0 :: Measurement-term precedence (subject/predicative mapping) -- atomic heuristic: 1) Purpose: when multiple monetary nouns (e.g., 'fair value', 'carrying amount', 'carrying value', 'face amount', 'principal', 'par value') appear in the same clause, map the numeric to the measurement term that is the grammatical subject or the clause-level predicated measurement (the quantity the sentence is asserting), NOT simply to the nearest monetary noun. 2) Measurement-term lexicon (case-insensitive): fair value, market value, carrying amount, carrying value, carrying value of, face amount, principal amount, par value, book value, carrying balance, net book value. Map these lexicon entries to corresponding US GAAP tags (e.g., 'fair value' -> LongTermDebtFairValue when instrument anchor = long-term debt; 'carrying amount'/'carrying value' -> DebtInstrumentCarryingAmount). 3) Dependency-parse rule (preferred): if dependency parse available, locate the numeric token's clause; find the noun phrase that is the subject (nsubj) of the main verb (copula or verb like approximated/amounted/was/is/represented/totaled). If that subject noun phrase contains a measurement-term from the lexicon, assign numeric -> that measurement-term's tag. 4) Verb cue list (match within same clause): was|is|were|are|approximated|approximates|approximated to|equaled|equals|amounted to|amounts to|represented|totaled|comprised|included|reported|measured at. Use these to identify predicative constructions. 5) Regex fallback patterns (use when no parse): a) Pattern A (subject-predicate): /\\b(the|its|our|their)\\s+(fair value|market value|carrying amount|carrying value|book value|net book value)\\s+(was|is|approximated|approximates|amounted to|equaled|totaled|represented)\\s+(?:the\\s+)?(?:carrying\\s+amount\\s+of\\s+)?\\$?([0-9]{1,3}[\\d,]*(?:\\.\\d+)?)/i => map captured $ to measurement-term in subject (fair value wins). Example: 'The fair value of our debt obligations approximated the carrying amount of $73,000' => numeric maps to fair value. b) Pattern B (X approximated the carrying amount of $Y): /\\b(fair value|market value|book value)\\b[^\\.\\,]{0,60}?\\bapproximat(?:e|ed|es)\\b[^\\.\\,]{0,60}?\\bcarrying amount of\\s*\\$?([0-9,\\.]+)/i => map $ to first captured measurement (fair value). c) Pattern C (predicate is measurement term): /\\b(the\\s+carrying amount|the\\s+carrying value|the\\s+fair value|the\\s+face amount|par value)\\s+of\\s+[^,\\.]+\\s+(was|is|amounted to|totaled|equaled)\\s*\\$?([0-9,\\.]+)/i => if subject exists and differs (e.g., subject = 'fair value' approximated 'carrying amount of $X') apply subject precedence rule to map $ to subject's measurement-term when subject measurement-term present earlier in sentence. 6) Fallback tie-breakers (apply only if neither parse nor regex matches): a) If numeric is inside a prepositional 'of' phrase modifying a monetary noun (e.g., 'carrying amount of $X') but the sentence contains a different measurement-term that is the grammatical subject or occurs before the verb with a verb-cue (e.g., 'fair value approximated ...'), prefer the earlier-measured subject term. b) If no subject/predicate measurement-term is found, fall back to nearest monetary noun as before but flag the mapping with tag 'measurement-term-ambiguous' for human review. 7) Token/window policy: when using regex or heuristic windows, limit context to the same sentence; allow antecedent resolution to previous sentence only when anaphoric referents ('the fair value', 'that amount') clearly refer to instrument and antecedent span <= 40 tokens. 8) Instrument linking: after resolving measurement-term, ensure instrument anchor (debt/long-term debt) is detected in clause or prior sentence; map 'fair value' to LongTermDebtFairValue only when instrument context indicates long-term debt; otherwise map to generic fair-value tag for the asset/liability type and flag for review if ambiguous. 9) Logging & QA: when this rule overrides a nearest-noun heuristic, tag the mapping record with 'measurement-term-precedence' plus spans of subject-measurement-term, predicate-verb, and numeric token. Add failing-sentence unit-test(s): - 'At December 31, 2016, the fair value of our debt obligations approximated the carrying amount of $73,000.' -> $73,000 = LongTermDebtFairValue. - 'The fair value of the available-for-sale securities was $5,000.' -> $5,000 = FairValueForAvailableForSaleSecurities (appropriate fair-value tag). - 'The carrying amount was $10,000.' -> $10,000 = DebtInstrumentCarryingAmount (explicit carrying amount subject). 10) Implementation note: apply this measurement-term precedence before lexical nearest-match fallbacks and before any instrument-specific tie-breaker. Add all mapped examples that used nearest-noun before this rule to a retraining queue labeled 'measurement-term-conflict'.\n[ctx-00003] helpful=0 harmful=0 :: Tax-rate statutory mapping (atomic): - Purpose: deterministically map percentage tokens explicitly labeled as statutory/federal income tax rates to EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate. - Exact lexical cues (case-insensitive regex examples): /\\b(statutor(y|ily)|statutory\\s+rate)\\b/, /\\b(U\\.?S\\.?|US|United\\s+States)\\s+(statutor(y|ily)|statutory)\\b/, /\\b(federal\\s+statutory|corporate\\s+federal\\s+income\\s+tax\\s+rate|U\\.S\\.\\s+statutory\\s+rate|statutory\\s+federal\\s+income\\s+tax\\s+rate)\\b/, /\\b(U\\.S\\.\\s+statutory\\s+rate)\\b/, /\\b(statutory\\s+income\\s+tax\\s+rate)\\b/. - Association window: require the percentage token (e.g., 35%, 21%) to appear within the same noun phrase or within ±4 tokens of any of the cues above, or anywhere in the same sentence when the cue and percentage clearly form the same measurement phrase (e.g., 'a statutory federal income tax rate of 35%'). - Precedence: when matched, assign EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate and override generic effective-tax tags or other percentage-tag candidates. - Conflict rule: if multiple tax-rate tags exist (statutory vs. effective vs. state/local), prefer the reconciliation/statutory tag when 'statutory'/'federal'/'U.S.' lexical cue is present; if the sentence additionally includes 'state', 'local', or separate jurisdiction cues, prefer jurisdiction-specific statutory tag if available and log multi-jurisdiction ambiguity. - Unit-tests (atomic examples): - 'the U.S. statutory rate of 35%' -> 35% = EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate. - 'a corporate federal income tax rate of 21%' -> 21% = EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate. - 'the statutory federal income tax rate was 35%' -> 35% = EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate. - Logging: record cue span and percentage span and label mapping as 'statutory-tax-rate-mapped' for QA/training. - Implementation note: apply this mapping before generic percentage-to-tag fallbacks and before any nearest-lexical-match tie-breaker.\n[ctx-00005] helpful=1 harmful=0 :: Measurement-aware customer-concentration mapping (atomic heuristic):\n- Purpose: ensure percentage tokens that quantify a named customer's share of a specific measure (revenue, trade receivables, other) map to the most specific concentration tag available in the taxonomy rather than always to the generic ConcentrationRiskPercentage1.\n- Detection patterns (case-insensitive; apply to the sentence containing the percentage and ±1 surrounding sentence for antecedents):\n  - customer anchor cues: /\\b(customer|customers|client|clients|Tech\\s+Data|the\\s+customer)\\b/ within ±10 tokens of the percentage or elsewhere in same sentence. Require a named-customer token OR lexical 'customer(s)' anchor to consider customer-concentration mapping.\n  - revenue measurement cues: /\\b(revenue|revenues|total\\s+net\\s+revenue|net\\s+revenue|sales)\\b/ within ±10 tokens of the percentage or in an immediately adjoining noun phrase 'of (our|the|Company's) (total\\s+net\\s+)?revenue'.\n  - receivables measurement cues: /\\b(accounts?\\s+receivable|trade\\s+accounts\\s+receivable|receivables|trade\\s+receivables)\\b/ within ±10 tokens of the percentage or in 'of (our|the) trade accounts receivable'.\n- Taxonomy lookup & selection algorithm (atomic steps):\n  1) Upon detecting a percentage token and a customer anchor, extract the nearest measurement-cue (revenue OR receivable) within ±10 tokens; if none found, mark measurement = 'unspecified'.\n  2) Query the taxonomy for candidate concentration tags whose names or metadata contain measurement qualifiers (search for token groups: ['revenue','receivable','receivables','accounts receivable','trade receivable','sales']).\n  3) If measurement == 'revenue' and taxonomy contains any tag whose id/name contains revenue-related token(s) (e.g., ...RevenueConcentration..., ...ConcentrationPercentageOfRevenue...), select the most specific revenue-tag. If multiple revenue-specific tags exist, prefer the one with the closest lexical match (e.g., 'total net revenue' > 'revenue').\n  4) If measurement == 'receivable' and taxonomy contains any receivable-specific concentration tag, select the most specific receivable-tag.\n  5) If measurement == 'unspecified' OR no measurement-specific tag exists in taxonomy, select generic ConcentrationRiskPercentage1.\n  6) If taxonomy contains both revenue- and receivable-specific tags but measurement cue matches neither or both ambiguously, flag as 'concentration-measurement-ambiguous' for human review rather than auto-assigning generic tag.\n- Precedence & tie-breakers (apply in order):\n  a) Exact phrase match to measurement (e.g., 'total net revenue', 'trade accounts receivable') -> choose taxonomy tag whose metadata/name contains that exact phrase.\n  b) Measurement-category match (revenue vs receivable) -> choose tag with matching category token.\n  c) If both revenue and receivable cues appear in same sentence referring to different percentages, resolve each percentage by its nearest measurement cue; do not conflate.\n  d) If proximity equal and both tag types exist, flag for review (do not default to generic without logging).\n- Token windows and antecedent resolution:\n  - Primary window: ±10 tokens around percentage for measurement cues.\n  - Antecedent window: allow measurement-anchor in immediately preceding sentence (±1 sentence) when anaphoric phrases ('the receivables', 'those revenues') appear; antecedent span must be <= 40 tokens.\n- Unit-tests (atomic examples to add):\n  - 'Tech Data accounted for 7% of Autodesk's total net revenue.' -> 7% = (taxonomy tag that contains 'revenue' e.g., ConcentrationRiskPercentageRevenue) else ConcentrationRiskPercentage1.\n  - 'Tech Data accounted for 5% of trade accounts receivable.' -> 5% = (taxonomy tag that contains 'receivable' e.g., ConcentrationRiskPercentageReceivables) else ConcentrationRiskPercentage1.\n  - 'Our largest customer represented 22%.' (no measurement cue) -> flag 'concentration-measurement-ambiguous' and queue for human review; do NOT auto-map to revenue-specific tag.\n- Logging & QA: always record the percentage span, customer anchor span, measurement cue span, chosen taxonomy tag id, and whether a measurement-specific tag was found. For any fallback to generic ConcentrationRiskPercentage1, record which measurement-specific candidate tags were present in taxonomy and why they were not chosen (absent/mismatch/ambiguous) to support retraining.\n- Implementation note: apply this heuristic before any generic 'customer+percent -> ConcentrationRiskPercentage1' fallback. Make the taxonomy-query a deterministic step in the mapping pipeline so that future additions to the taxonomy (e.g., revenue- or receivable-specific concentration tags) are automatically preferred when measurement cues exist.\n[ctx-00006] helpful=0 harmful=0 :: ctx-000XX :: Percent-as-instrument-coupon (atomic heuristic to map percent tokens that are lexical modifiers of debt instrument names to DebtInstrumentInterestRateStatedPercentage)\n- Purpose: deterministically map percentage tokens that directly modify or are explicitly tied to debt-instrument nouns to DebtInstrumentInterestRateStatedPercentage, even when 'per annum' is absent.\n- Exact lexical patterns (case-insensitive regexes; apply before generic percent fallbacks):\n  1) Percent-before-instrument (adjacent modifier): /\\b([0-9]+(?:\\.[0-9]+)?)\\s*%\\s*(?:coupon\\s+)?\\s*(?:on\\s+)?(?:the\\s+)?(senior\\s+notes|senior\\s+note|notes|note|term\\s+loan|loan|revolver|seller\\s+note|debenture|obligation)s?\\b/i\n  2) Instrument-bearing-percent (instrument then explicit verb/phrase): /\\b(senior\\s+notes|senior\\s+note|notes|note|term\\s+loan|loan|revolver|seller\\s+note|debenture|obligation)s?\\b[\\s\\S]{0,40}?\\b(?:bearing\\s+interest\\s+at|bearing\\s+interest\\s+of|with\\s+interest\\s+of|with\\s+an\\s+interest\\s+rate\\s+of|at|rates?\\s+of)\\s*([0-9]+(?:\\.[0-9]+)?)\\s*%/i\n  3) Parenthetical/inline: /\\b(senior\\s+notes|notes|term\\s+loan|revolver)\\b[^,\\n\\r]{0,40}?\\(.*?([0-9]+(?:\\.[0-9]+)?)\\s*%.*?\\)/i\n- Association window & adjacency rule:\n  - For pattern (1), require percent token to be adjacent to or within 1 token of the instrument noun (effectively immediate modifier): treat as direct coupon modifier.\n  - For pattern (2)/(3), allow up to 40-token span across intervening descriptive words but require explicit linking verbs/phrases ('bearing interest at', 'with interest of', 'at') to assert instrument-rate relation.\n- Precedence & conflict resolution (apply in order):\n  1) If Percent-as-instrument-coupon pattern matches -> assign DebtInstrumentInterestRateStatedPercentage and link mapping to the detected instrument anchor (capture instrument span). This mapping overrides generic percentage tags (e.g., concentration, generic 'percentage' tags) and overrides spread tags unless a spread indicator is also present (see 2).\n  2) If the sentence also contains explicit spread/basis cues (LIBOR/ABR + 'plus'/'over' or 'margin'/'spread' within ±6 tokens of the percent) -> prefer DebtInstrumentBasisSpreadOnVariableRate1 for that percent and log 'rate-vs-spread-conflict' (do not auto-assign stated-rate). Only assign stated-rate if the percent is syntactically a modifier of the instrument name (pattern 1) and no spread cues are present.\n  3) If both 'per annum' and an instrument-anchor are present but text also contains 'plus'/'LIBOR', prefer spread mapping for the LIBOR-plus form; otherwise prefer DebtInstrumentInterestRateStatedPercentage.\n- Tag-linking requirement: when assigning DebtInstrumentInterestRateStatedPercentage, also capture and record the instrument anchor span (e.g., 'Senior Notes') so that downstream QA can link the rate to the correct debt instrument id.\n- Unit-tests / atomic examples to add:\n  - 'we issued 2.250% Senior Notes due 2025' -> 2.250% = DebtInstrumentInterestRateStatedPercentage (instrument anchor: Senior Notes).\n  - 'Senior Notes bearing interest at 2.250% were issued' -> 2.250% = DebtInstrumentInterestRateStatedPercentage.\n  - 'The interest rate is 4.15% per annum on the term loan' -> 4.15% = DebtInstrumentInterestRateStatedPercentage (covered by existing per-annum rule; ensure no regression).\n  - 'LIBOR plus 4.15%' alongside 'Senior Notes at 4.15%' -> percent next to 'LIBOR plus' = DebtInstrumentBasisSpreadOnVariableRate1; percent adjacent to 'Senior Notes' = DebtInstrumentInterestRateStatedPercentage; log if same numeric appears in conflicting positions.\n- Logging & QA: record percent token span, instrument anchor span, matched pattern id (1/2/3), chosen tag id, and any conflict reason. If mapping overrides a previously considered spread/market tag, add sample to 'rate-vs-spread-conflict' queue for human review and inclusion in unit-tests.\n- Implementation note: insert this rule into the pipeline before generic percentage-to-tag heuristics and before classifier fallbacks so that adjacency-based stated-rate matches win deterministically.\n[ctx-00008] helpful=0 harmful=0 :: Atomic lexical rule: map 'aggregate principal amount' / 'principal amount' -> DebtInstrumentFaceAmount\n- Purpose: deterministically tag currency amounts that state the face/aggregate principal amount of a debt instrument as DebtInstrumentFaceAmount and avoid mis-mapping to facility-capacity or generic amount tags.\n- Exact lexical cues/regex (case-insensitive): /\\baggregate\\s+principal\\s+amount\\s+of\\b/, /\\baggregate\\s+principal\\s+amount\\b/, /\\bprincipal\\s+amount\\s+of\\b/, /\\bin\\s+an?\\s+aggregate\\s+principal\\s+amount\\b/, /\\baggregate\\s+principal\\s+amount\\s+of\\s+up\\s+to\\b/\n- Instrument-anchor detection (case-insensitive regex list): /\\b(senior\\s+notes|senior\\s+note|notes|note|debentures?|bonds?|term\\s+loan|term\\s+loans|loan|loans|seller\\s+note)s?\\b/ — when one of these appears in same sentence (primary) or previous sentence within antecedent span <= 40 tokens, treat as debt-instrument anchor.\n- Association window: require numeric currency token to lie within ±8 tokens of the principal/aggregate phrase; if anchor is only in prior sentence allow numeric within ±16 tokens of antecedent anchor but require anaphoric referent (\"the Notes\", \"such notes\").\n- Mapping rule (precedence):\n  1) If principal/aggregate cue matches AND a debt-instrument anchor (notes/bonds/term loan/etc.) is present -> assign DebtInstrumentFaceAmount and link mapping to instrument anchor span.\n  2) If principal/aggregate cue matches BUT anchor indicates a credit facility/revolver (e.g., 'revolver', 'credit facility') -> treat as LineOfCreditFacilityMaximumBorrowingCapacity (facility-size), unless explicit remaining-amount phrase ('amount available', 'borrowing base') is present in which case follow remaining-capacity rules (ctx-00009 / ctx-00005).\n  3) Do NOT override measurement-term precedence: if the sentence explicitly states a measurement term with grammatical subject/predicate (e.g., 'the fair value of our Senior Notes was $X') then the measurement-term precedence rule (ctx-00002) wins — log as 'face-vs-measurement' when both cues occur.\n- Conflict handling & logging: record numeric span, principal-cue span, instrument-anchor span, chosen tag id, and whether a facility-anchor caused a capacity mapping. If both face-amount and another measurement (fair value/carrying amount) are present, log as 'face-vs-measurement' and retain the measurement-term precedence decision.\n- Unit-tests (atomic examples):\n  • 'The 3.550% Senior Notes had an aggregate principal amount of $600 million.' -> $600 million = DebtInstrumentFaceAmount (anchor: Senior Notes).\n  • 'Aggregate principal amount of $600 million of our Senior Notes was issued' -> $600 million = DebtInstrumentFaceAmount.\n  • 'Revolving credit facility in an aggregate principal amount of up to $225.0 million' -> $225.0 million = LineOfCreditFacilityMaximumBorrowingCapacity (facility anchor -> capacity mapping).\n  • 'The fair value of our Senior Notes was $487 million and the aggregate principal amount was $500 million' -> $487M = LongTermDebtFairValue (measurement-term precedence); $500M = DebtInstrumentFaceAmount (face mapping); log 'face-vs-measurement' with spans.\n- Implementation notes: insert this rule before generic currency-to-tag fallbacks and after measurement-term precedence check; capture instrument anchor span for QA and downstream linking. Add unit-tests above to regression suite and surface any 'face-vs-measurement' conflicts to review queue.\n[ctx-00010] helpful=0 harmful=0 :: Share-based-compensation: exact lexical guards for per-share fair value vs aggregate intrinsic value vs counts (atomic heuristic)\n- Purpose: deterministically map numeric tokens that appear in share-based compensation sentences to the most-specific US GAAP tag (weighted-average grant-date fair value per share for equity awards other than options; total intrinsic value of options exercised; grants-in-period counts). Apply this BEFORE generic 'per share' or 'count' fallbacks.\n- Exact lexical cues & regexes (case-insensitive):\n  1) Grant-date per-share fair value (map -> ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsGrantsInPeriodWeightedAverageGrantDateFairValue): /grant[- ]date\\s+fair\\s+value/ and /per\\s+share/ within same clause; variants: /weighted[- ]average\\s+grant[- ]date\\s+fair\\s+value/; parenthetical surface forms: /\\(.*?grant[- ]date\\s+fair\\s+value.*?per\\s+share.*?\\)/. Example matches: \"grant date fair value per share\", \"(grant date fair value of $X per share)\".\n  2) Aggregate intrinsic value of options exercised (map -> ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsExercisesInPeriodTotalIntrinsicValue): /aggregate\\s+intrinsic\\s+value/ and /(exercis(?:e|ed)|exercised\\s+in\\s+the\\s+period|exercised\\s+during)/ within same sentence/clause. Example matches: \"aggregate intrinsic value of options exercised in the period was $572,000\".\n  3) Grants-in-period counts for equity instruments other than options (map -> ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsGrantsInPeriod): grant-count cues: /\\b(granted\\s+(during|in|for)|grants?(?:\\s+for|\\s+during|\\s+in)|were\\s+granted)\\b/ and numeric token with 'shares' or unit words (shares, RSUs) within ±8 tokens. Example: \"There were 8,000 restricted shares granted during the period.\" \n- Association windows & parenthetical linking:\n  - Primary association window: numeric token must be within ±8 tokens of the matched cue (grant-date fair value / aggregate intrinsic value / 'granted' count). If numeric appears inside parentheses immediately adjacent to a grant/award phrase (parenthetical directly follows or is embedded in the same noun phrase/clause), treat it as linked to that grant phrase even if token distance >8 but within same clause.\n  - Allow antecedent anchor resolution to the immediately preceding sentence (±1 sentence) only when an anaphor ('the grants','such awards','the RSU grants') is present and antecedent span <=40 tokens. Otherwise require same-sentence match.\n- Precedence & tie-breaker (atomic): when multiple share-compensation candidates match the same numeric token, apply in order:\n  1) If 'aggregate intrinsic value' + 'exercised' matches -> choose OptionsExercisesInPeriodTotalIntrinsicValue.\n  2) Else if 'grant date fair value' + 'per share' or 'weighted-average grant-date fair value' matches -> choose GrantsInPeriodWeightedAverageGrantDateFairValue (equity other than options).\n  3) Else if explicit grant-count cue ('granted', 'grants for the period') with unit 'shares'/'RSUs' matches -> choose GrantsInPeriod count tag.\n  4) If a numeric is a currency and both a per-share and an aggregate cue appear (e.g., $X per share and $Y aggregate in same clause), map each numeric to the respective cue: per-share -> weighted-average per-share tag; aggregate -> total intrinsic/aggregate-fair-value tag accordingly.\n  5) If equal-distance ambiguity persists, prefer the explicit verb cue explaining action (\"granted\", \"exercised\") over nominal cues alone.\n- Negative prevention rules (atomic):\n  - Do NOT map a per-share currency numeric to a count tag; require presence of unit tokens (\"shares\",\"RSUs\") to map to counts.\n  - Do NOT map an 'aggregate intrinsic value' phrase to a per-share fair-value tag. The word 'aggregate' + 'intrinsic value' strongly signals a total-dollar intrinsic value; assign the options-exercise total-intrinsic tag.\n- Unit-tests (atomic examples to add):\n  1) 'The weighted-average grant-date fair value of restricted stock awards granted during the period was $12.50 per share.' -> $12.50 = ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsGrantsInPeriodWeightedAverageGrantDateFairValue.\n  2) 'Aggregate intrinsic value of stock options exercised during the year was $572,000.' -> $572,000 = ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsExercisesInPeriodTotalIntrinsicValue.\n  3) 'There were 8,000 restricted shares granted during the year.' -> 8,000 = ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsGrantsInPeriod.\n  4) 'Included in the grants (grant date fair value of $5.00 per share) are ...' -> $5.00 = GrantsInPeriodWeightedAverageGrantDateFairValue (parenthetical linking).\n- Logging & QA: for each auto-mapping record the matched cue span, numeric span, parenthetical flag (true if numeric was inside parentheses adjacent to grant clause), chosen tag id, and tie-breaker rationale. Queue any example where 'per share' numeric lacks a nearby grant/award anchor or where 'aggregate' and 'per share' cues conflict for human review.\n- Implementation note: insert this heuristic as the first step in the share-based-compensation numeric-tagging pipeline and add the unit-tests above to regression suites.\n## OTHERS\n[misc-00002] helpful=0 harmful=0 :: Micro decision flow for acquisition-related monetary phrases (apply in order): 1) Search sentence (or immediate surrounding sentence ±1) for the exact phrase variants from the lexical-to-tag mapping. 2) If only one cue matches, assign the corresponding tag. 3) If multiple cues match, choose the cue whose token span is closest to the numeric amount (measure token-distance from numeric token to cue span). 4) If both cues are equidistant or no numeric amount is present, break ties by cue specificity: ('purchase price' > 'cash paid' > 'consideration'). 5) If still ambiguous, prefer PaymentsToAcquireBusinessesGross when the sentence explicitly mentions payments, cash, or amounts described as 'paid' or 'paid as part of the acquisition'; prefer BusinessCombinationConsiderationTransferred1 only when the text uses 'consideration' or explicitly 'consideration transferred' and describes the composition of consideration (e.g., cash + shares + other instruments). 6) Log ambiguous cases for human review and add the sentence to a short test-suite.\n\n**Reflection:**\n{\n  \"reasoning\": \"I compared each predicted tag to the ground truth and traced the model's mapping decisions. The model correctly mapped both 5.1 and 7.9 (amortization expense amounts) to AmortizationOfIntangibleAssets because the sentence explicitly labels these values as \\\"Amortization expense for intangible assets.\\\" The model also correctly mapped 550 (the term loan amount) to DebtInstrumentFaceAmount because a term loan principal maps to a debt instrument face amount. The only mismatch is the third item: the model mapped \\\"$400 million revolving credit facility\\\" to LineOfCreditFacilityMaximumBorrowingCapacity, while the ground truth is LineOfCreditFacilityCurrentBorrowingCapacity. The model applied a heuristic that any stated facility size equals the facility's maximum/commitment amount. However, the sentence simply describes the size of the revolving credit facility at inception (\\\"a $400 million revolving credit facility\\\"), which in the labeling convention used here corresponds to the facility's current borrowing capacity rather than the explicit concept of \\\"maximum borrowing capacity.\\\"\",\n  \"error_identification\": \"The model chose LineOfCreditFacilityMaximumBorrowingCapacity for the $400 million revolving credit facility when the correct tag is LineOfCreditFacilityCurrentBorrowingCapacity.\",\n  \"root_cause_analysis\": \"The error arose from a semantic misinterpretation of the phrase \\\"a $400 million revolving credit facility.\\\" The model conflated the facility amount with the concept of a facility's maximum or committed size. It applied an over-broad heuristic (\\\"facility size -> maximum borrowing capacity\\\") without checking lexical cues or dataset/tagging conventions that distinguish current borrowing capacity from maximum/commitment amounts.\",\n  \"correct_approach\": \"Map the $400 million revolving credit facility to LineOfCreditFacilityCurrentBorrowingCapacity. Use lexical cues and tagging conventions: when a sentence states the size of a facility (e.g., \\\"a $X revolving credit facility,\\\" \\\"consisting of a $X facility\\\") and no modifier like \\\"maximum,\\\" \\\"commitment,\\\" or \\\"unused capacity\\\" appears, prefer the CurrentBorrowingCapacity tag. Reserve the MaximumBorrowingCapacity tag for explicit language about maximum/committed limits (words like \\\"maximum,\\\" \\\"commitment,\\\" \\\"facility maximum,\\\" or references to the lender's committed amount).\",\n  \"key_insight\": \"Distinguish facility amount semantics: absence of explicit 'maximum' or 'commitment' language typically indicates current borrowing capacity rather than maximum capacity. Rely on exact lexical cues (maximum, commitment, remaining, unused) to choose between LineOfCreditFacilityMaximumBorrowingCapacity and LineOfCreditFacilityCurrentBorrowingCapacity.\",\n  \"bullet_tags\": []\n}\n\n**Question:**\nYou are XBRL expert.  Here is a list of US GAAP tags options: ,OperatingLeasesRentExpenseNet,MinorityInterestOwnershipPercentageByParent,ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsGrantsInPeriodWeightedAverageGrantDateFairValue,DerivativeNotionalAmount,PreferredStockDividendRatePercentage,GuaranteeObligationsMaximumExposure,LossContingencyEstimateOfPossibleLoss,OperatingLeaseRightOfUseAsset,NumberOfOperatingSegments,PaymentsToAcquireBusinessesNetOfCashAcquired,DebtInstrumentBasisSpreadOnVariableRate1,InterestExpense,ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsNonvestedNumber,CommonStockSharesOutstanding,StockRepurchaseProgramRemainingAuthorizedRepurchaseAmount1,LineOfCreditFacilityInterestRateAtPeriodEnd,ContractWithCustomerLiabilityRevenueRecognized,AmortizationOfIntangibleAssets,ShareBasedCompensationArrangementByShareBasedPaymentAwardAwardVestingPeriod1,DebtInstrumentRedemptionPricePercentage,RepaymentsOfDebt,DisposalGroupIncludingDiscontinuedOperationConsideration,LineOfCreditFacilityRemainingBorrowingCapacity,BusinessCombinationAcquisitionRelatedCosts,LesseeOperatingLeaseRenewalTerm,TreasuryStockValueAcquiredCostMethod,PreferredStockSharesAuthorized,RelatedPartyTransactionExpensesFromTransactionsWithRelatedParty,ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsVestedInPeriodTotalFairValue,UnrecognizedTaxBenefitsThatWouldImpactEffectiveTaxRate,SaleOfStockNumberOfSharesIssuedInTransaction,OperatingLeaseWeightedAverageRemainingLeaseTerm1,StockRepurchaseProgramAuthorizedAmount1,SupplementalInformationForPropertyCasualtyInsuranceUnderwritersPriorYearClaimsAndClaimsAdjustmentExpense,RelatedPartyTransactionAmountsOfTransaction,CommonStockDividendsPerShareDeclared,IncomeLossFromEquityMethodInvestments,DebtInstrumentMaturityDate,LettersOfCreditOutstandingAmount,AllocatedShareBasedCompensationExpense,EffectiveIncomeTaxRateContinuingOperations,ShareBasedCompensationArrangementByShareBasedPaymentAwardNumberOfSharesAuthorized,ShareBasedCompensationArrangementByShareBasedPaymentAwardNumberOfSharesAvailableForGrant,ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsGrantsInPeriodGross,ConcentrationRiskPercentage1,OperatingLeasePayments,LongTermDebt,RestructuringCharges,CommonStockParOrStatedValuePerShare,DebtInstrumentConvertibleConversionPrice1,Revenues,DeferredFinanceCostsGross,EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate,DefinedBenefitPlanContributionsByEmployer,GoodwillImpairmentLoss,LossContingencyPendingClaimsNumber,OperatingLeaseLiability,LineOfCreditFacilityMaximumBorrowingCapacity,OperatingLeaseExpense,DerivativeFixedInterestRate,LineOfCreditFacilityCommitmentFeePercentage,CumulativeEffectOfNewAccountingPrincipleInPeriodOfAdoption,SharebasedCompensationArrangementBySharebasedPaymentAwardAwardVestingRightsPercentage,DebtWeightedAverageInterestRate,PaymentsToAcquireBusinessesGross,DebtInstrumentCarryingAmount,BusinessCombinationRecognizedIdentifiableAssetsAcquiredAndLiabilitiesAssumedIntangibles,RevenueFromContractWithCustomerExcludingAssessedTax,PublicUtilitiesRequestedRateIncreaseDecreaseAmount,ContractWithCustomerLiability,DebtInstrumentTerm,DebtInstrumentFairValue,RevenueFromContractWithCustomerIncludingAssessedTax,RevenueFromRelatedParties,DebtInstrumentInterestRateEffectivePercentage,GainsLossesOnExtinguishmentOfDebt,EmployeeServiceShareBasedCompensationNonvestedAwardsTotalCompensationCostNotYetRecognizedShareBasedAwardsOtherThanOptions,DebtInstrumentUnamortizedDiscount,LineOfCreditFacilityCurrentBorrowingCapacity,CashAndCashEquivalentsFairValueDisclosure,LesseeOperatingLeaseTermOfContract,RestructuringAndRelatedCostExpectedCost1,DefinedContributionPlanCostRecognized,OperatingLeaseCost,LossContingencyDamagesSoughtValue,ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsGrantsInPeriodWeightedAverageGrantDateFairValue,ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsGrantsInPeriod,EmployeeServiceShareBasedCompensationNonvestedAwardsTotalCompensationCostNotYetRecognizedPeriodForRecognition1,EmployeeServiceShareBasedCompensationNonvestedAwardsTotalCompensationCostNotYetRecognized,FiniteLivedIntangibleAssetUsefulLife,Depreciation,AcquiredFiniteLivedIntangibleAssetsWeightedAverageUsefulLife,DeferredFinanceCostsNet,DebtInstrumentInterestRateStatedPercentage,Goodwill,CommonStockCapitalSharesReservedForFutureIssuance,LongTermDebtFairValue,OperatingLossCarryforwards,InterestExpenseDebt,UnrecognizedTaxBenefits,BusinessCombinationContingentConsiderationLiability,TreasuryStockAcquiredAverageCostPerShare,ClassOfWarrantOrRightExercisePriceOfWarrantsOrRights1,SharebasedCompensationArrangementBySharebasedPaymentAwardExpirationPeriod,NumberOfRealEstateProperties,TreasuryStockSharesAcquired,AntidilutiveSecuritiesExcludedFromComputationOfEarningsPerShareAmount,CommonStockSharesAuthorized,SharePrice,DebtInstrumentFaceAmount,AmortizationOfFinancingCosts,BusinessCombinationConsiderationTransferred1,LineOfCreditFacilityUnusedCapacityCommitmentFeePercentage,StockRepurchasedDuringPeriodShares,ProceedsFromIssuanceOfCommonStock,StockIssuedDuringPeriodSharesNewIssues,AccrualForEnvironmentalLossContingencies,BusinessAcquisitionPercentageOfVotingInterestsAcquired,LossContingencyAccrualAtCarryingValue,OperatingLeaseWeightedAverageDiscountRatePercent,ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsExercisesInPeriodTotalIntrinsicValue,BusinessAcquisitionEquityInterestsIssuedOrIssuableNumberOfSharesIssued,CapitalizedContractCostAmortization,NumberOfReportableSegments,AssetImpairmentCharges,RevenueRemainingPerformanceObligation,EquityMethodInvestmentOwnershipPercentage,MinorityInterestOwnershipPercentageByNoncontrollingOwners,AreaOfRealEstateProperty,StockRepurchasedAndRetiredDuringPeriodShares,LineOfCredit,BusinessCombinationRecognizedIdentifiableAssetsAcquiredAndLiabilitiesAssumedIntangibleAssetsOtherThanGoodwill,IncomeTaxExpenseBenefit,PropertyPlantAndEquipmentUsefulLife,LeaseAndRentalExpense,ShareBasedCompensation,EquityMethodInvestments,SaleOfStockPricePerShare,EmployeeServiceShareBasedCompensationTaxBenefitFromCompensationExpense. Answer the following 4 independent questions by providing only  4 US GAAP tags answers in the order of the questions. Each answer must be saperated by a comma (,).  Provide nothing else. \n1. What is best tag for entity \"5.1\" in sentence: \"The following table reflects these intangible assets by major category : Amortization expense for intangible assets was $ 7.7 million , $ 5.1 million and $ 7.9 million for 2018 , 2017 and 2016 , respectively .?\"\n2. What is best tag for entity \"7.9\" in sentence: \"The following table reflects these intangible assets by major category : Amortization expense for intangible assets was $ 7.7 million , $ 5.1 million and $ 7.9 million for 2018 , 2017 and 2016 , respectively .?\"\n3. What is best tag for entity \"400\" in sentence: \"Debt and Credit Agreements In November 2016 , the Company entered into a senior secured credit facility ( the “ Senior Secured Credit Facility ” ) , consisting of a $ 400 million revolving credit facility ( the \" Revolving Credit Facility \" ) and a $ 550 million term loan facility ( the \" Term Loan Facility \" ) .?\"\n4. What is best tag for entity \"550\" in sentence: \"Debt and Credit Agreements In November 2016 , the Company entered into a senior secured credit facility ( the “ Senior Secured Credit Facility ” ) , consisting of a $ 400 million revolving credit facility ( the \" Revolving Credit Facility \" ) and a $ 550 million term loan facility ( the \" Term Loan Facility \" ) .?\"\nOutput US GAAP tags:\n\n**Context:**\n\n\n**Answer in this exact JSON format:**\n{\n  \"reasoning\": \"[Your chain of thought / reasoning / thinking process, detailed analysis and calculations]\",  \n  \"bullet_ids\": [\"calc-00001\", \"fin-00002\"],  \n  \"final_answer\": \"[Your concise final answer here]\"\n}\n\n---\n",
  "response": "{\n  \"reasoning\": \"1) The sentence explicitly states \\\"Amortization expense for intangible assets was $... $5.1 ...\\\" — lexical measurement cue ('Amortization expense for intangible assets') directly ties the numeric to amortization of intangible assets. By measurement-term precedence, map 5.1 -> AmortizationOfIntangibleAssets. 2) Same sentence and same lexical cue; map 7.9 -> AmortizationOfIntangibleAssets. 3) \\\"consisting of a $400 million revolving credit facility\\\" names a credit facility and states its size without qualifiers like 'maximum', 'up to', or 'commitment'. Per facility rules (absence of 'maximum' language -> treat as current facility size/available capacity), map 400 -> LineOfCreditFacilityCurrentBorrowingCapacity. 4) \\\"a $550 million term loan facility\\\" names a debt instrument (term loan) and states its principal amount; per principal/aggregate mapping for debt instruments, map 550 -> DebtInstrumentFaceAmount.\",\n  \"bullet_ids\": [\n    \"ctx-00002\",\n    \"ctx-00009\",\n    \"ctx-00008\"\n  ],\n  \"final_answer\": \"AmortizationOfIntangibleAssets,AmortizationOfIntangibleAssets,LineOfCreditFacilityCurrentBorrowingCapacity,DebtInstrumentFaceAmount\"\n}",
  "prompt_time": 0.0,
  "response_time": 16.6515531539917,
  "total_time": 16.6515531539917,
  "call_time": 16.6515531539917,
  "prompt_length": 87850,
  "response_length": 1169,
  "prompt_num_tokens": 20501,
  "response_num_tokens": 1376,
  "timestamp": "20260205_181254_549",
  "datetime": "2026-02-05T18:12:54.549243"
}